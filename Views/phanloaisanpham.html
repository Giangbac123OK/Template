<!DOCTYPE html> 
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phân Loại Sản Phẩm</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f8f8;
            padding: 20px;
        }
        .container {
            background-color: #fff;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
            color: #ff6b35; /* Màu cam chủ đạo */
        }
        .product-name {
            text-align: center;
            font-weight: normal;
            font-size: 1.1rem;
            color: #333;
            margin-bottom: 20px;
        }
        .category-group {
            margin-bottom: 20px;
            position: relative;
        }
        .category-header {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: #ff6b35; 
            font-size: 20px; /* Màu cam chủ đạo cho tiêu đề */
        }
        h5, .form-group label {
            font-weight: bold;
            color: #ff6b35; /* Màu cam cho nhãn Số lượng và Mô tả */
            font-size: 20px; /* Font-size 20px cho nhãn */
        }
        .form-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .form-control {
            border-color: #ff6b35; /* Màu cam cho viền ô nhập liệu */
        }
        .form-control:focus {
            border-color: #ff6b35;
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 53, 0.25);
        }
        .btn-add-product {
            background-color: #ff6b35; /* Màu cam cho nút thêm */
            color: #fff;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            font-weight: 600;
        }
        .btn-add-product:hover {
            background-color: #e85a29;
        }
        .product-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 30px;
        }
        .product-table th {
            background-color: #ff6b35; /* Màu cam cho tiêu đề bảng */
            color: #fff;
            padding: 10px;
            text-align: center;
        }
        .product-table td {
            padding: 10px;
            border: 1px solid #ddd;
            text-align: center;
            color: #333;
        }
        .edit-button {
            background-color: #ff9800;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            cursor: pointer;
        }
        .edit-button:hover {
            background-color: #e67e00;
        }
        /* Căn chỉnh tên thuộc tính lùi vào một tab */
        .attribute-pair .option {
            margin-left: 20px; /* Lùi vào một tab */
            font-size: 20px; /* Tăng kích thước font */
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2 class="header">PHÂN LOẠI SẢN PHẨM</h2>
        <h4 class="product-name" id="productName">Tên Sản Phẩm</h4>
        <div class="form-group">
            <h5 for="productQuantity">Số lượng:</h5>
            <input type="number" id="productQuantity" class="form-control" placeholder="Nhập số lượng" style="width: 100%;">
        </div>
        <div class="form-group">
            <h5 for="productDescription">Mô tả:</h5>
            <input type="text" id="productDescription" class="form-control" placeholder="Nhập mô tả" style="width: 100%;">
        </div>
        <div class="category-group">
            <h6 class="category-header">
                Thuộc Tính
                <span class="plus-icon-header">+</span>
            </h6>
            <div class="category-options" id="attribute-options">
                <!-- Các thuộc tính sẽ được thêm vào đây -->
            </div>
            <button class="btn-add-product">Thêm phân loại sản phẩm</button>
        </div>
    </div>

    <table class="product-table">
        <thead>
            <tr>
                <th>Tên sản phẩm</th>
                <th>Phân loại</th>
                <th>Mô tả</th>
                <th>Giá</th>
                <th>Số lượng</th>
                <th>Hành động</th>
            </tr>
        </thead>
        <tbody id="productTableBody">
            
        </tbody>
    </table>

    <script>
        // Lấy id và tên sản phẩm từ localStorage
        const productId = localStorage.getItem("selectedProductId");
        const productName = localStorage.getItem("selectedProductName");
        document.getElementById("productName").textContent = productName;

        // Hàm để thêm chi tiết cho từng thuộc tính
        function addAttributeDetail(attribute) {
            const newDetailName = prompt("Nhập chi tiết thuộc tính mới:");
            if (!newDetailName) {
                return;
            }

            // Thêm chi tiết vào mảng thuộc tính
            if (!attribute.Thuoctinhsanphamchitiets || !Array.isArray(attribute.Thuoctinhsanphamchitiets.$values)) {
                attribute.Thuoctinhsanphamchitiets = { $values: [] };
            }
            attribute.Thuoctinhsanphamchitiets.$values.push({
                Idtt: attribute.Id,
                Tenthuoctinhchitiet: newDetailName
            });

            renderAttributes();
        }

        function handleAddDetailClick(event) {
            const attributeElement = event.target.closest('.attribute-pair');
            const attributeName = attributeElement.querySelector('.option').textContent;
            const attribute = attributes.find(attr => attr.Tenthuoctinh === attributeName);

            if (attribute) addAttributeDetail(attribute);
        }

        function renderAttributes() {
            const attributeOptions = document.getElementById('attribute-options');
            attributeOptions.innerHTML = '';

            attributes.forEach(attribute => {
                const attributePair = document.createElement('div');
                attributePair.className = 'attribute-pair';

                const spanElement = document.createElement('span');
                spanElement.className = 'option';
                spanElement.textContent = attribute.Tenthuoctinh;

                const detailContainer = document.createElement('div');
                detailContainer.style.display = 'flex';
                detailContainer.style.alignItems = 'center';
                detailContainer.style.gap = '5px';

                if (attribute.Thuoctinhsanphamchitiets && attribute.Thuoctinhsanphamchitiets.$values.length > 0) {
                    attribute.Thuoctinhsanphamchitiets.$values.forEach(detail => {
                        const detailElement = document.createElement('span');
                        detailElement.className = 'attribute-detail';
                        detailElement.textContent = detail.Tenthuoctinhchitiet;
                        detailContainer.appendChild(detailElement);
                    });
                }

                const plusIcon = document.createElement('span');
                plusIcon.className = 'plus-icon';
                plusIcon.textContent = '+';
                plusIcon.addEventListener('click', handleAddDetailClick);
                detailContainer.appendChild(plusIcon);

                attributePair.appendChild(spanElement);
                attributePair.appendChild(detailContainer);
                attributeOptions.appendChild(attributePair);
            });
        }
        
        document.querySelector('.plus-icon-header').addEventListener('click', addAttribute);

        window.onload = function() {
            loadAttributes();
            loadProductDetails();
        };
    </script>
</body>
</html>
